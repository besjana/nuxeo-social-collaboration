<f:subview id="relation_picture_subview_#{widget.id}"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:h="http://java.sun.com/jsf/html">

  <nxu:set var="profileModel" value="#{userProfileActions.getUserProfileDocument(field.id)}" >
  <nxu:set var="profile" value="userprofile">

  <c:if test="#{empty profileModel[profile].avatar}">
    <h:graphicImage value="/icons/missing_avatar.png"
      title="Missing profile avatar" alt="Missing profile avatar" />
  </c:if>

  <c:if test="#{not empty profileModel[profile].avatar}">
    <nxu:set var="image_url"
    value="#{nxd:fileUrl('downloadFile', profileModel, 'userprofile:avatar', profileModel[profile].avatar.filename)}">
    <img src="#{image_url}"
      title="#{profileModel[profile].avatar.filename}" alt="#{profileModel[profile].avatar.filename}" />
  </nxu:set>
  </c:if>

  </nxu:set>
  </nxu:set>

</f:subview>
