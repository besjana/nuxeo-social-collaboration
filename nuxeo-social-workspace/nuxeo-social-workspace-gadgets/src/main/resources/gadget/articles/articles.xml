<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="Articles"
    description="Diplay public Articles of the Social Workspace"
    author="Eugen Ionica" author_email="ei@nuxeo.com"
    height="420">
    <Optional feature="nuxeo"/>
    <Require feature="setprefs"/>
    <#include "dynamic-translations.ftl"/>
    <Require feature="dynamic-height" />
    <#include "default-oauth-prefs.ftl"/>
  </ModulePrefs>
  <#include "context-prefs.ftl"/>
  <Content type="html">

<![CDATA[
<html>
  <head>
  <link rel="stylesheet" type="text/css" href="/nuxeo/site/skin/gadgets/css/gadget-common.css"/>
  <link rel="stylesheet" type="text/css" href="/nuxeo/site/skin/gadgets/css/documentlists.css"/>
  <link rel="stylesheet" type="text/css" href="articles.css"/>

  <!-- insert JS Context -->
  ${jsContext}

  <script src="${specDirectoryUrl}default-automation-request.js"></script>
  <script src="${specDirectoryUrl}context-management.js"></script>
  <script src="${specDirectoryUrl}default-documentlist-display.js"></script>
  <script type="text/javascript" language="javascript" src="articles.js"></script>
<script type="text/javascript" language="javascript">
// configure Automation REST call
var NXRequestParams={ operationId : 'Social.Provider',            // id of operation or chain to execute
  operationParams : { query : "Select * from Article WHERE ecm:isProxy = 0 and ecm:currentLifeCycleState <> 'deleted'",
       pageSize : 5,
       contextPath : getTargetContextPath(),
  },  // parameters for the chain or operation
  operationContext : {},                                                // context
  operationDocumentProperties : "common,dublincore,note",               // schema that must be fetched from resulting documents
  entityType : 'documents',                                             // result type : only document is supported for now
  usePagination : true,                                                 // manage pagination or not
  displayMethod : displayArticles,                                  // js method used to display the result
                   noEntryLabel: '__MSG_label.gadget.no.document__'
};
</script>
  </head>

  <body>
     <div class="content">
      <#include "default-documentlist-layout.ftl"/>
      <#include "default-request-controls.ftl"/>
    </div>
  </body>
</html>
]]>

  </Content>
</Module>
