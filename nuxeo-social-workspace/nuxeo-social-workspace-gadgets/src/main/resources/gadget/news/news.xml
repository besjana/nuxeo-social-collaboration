<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="News"
    description="Display News of the Social Workspace"
    author="Ronan Le Gall" author_email="rlg@nuxeo.com"
    height="420">
    <Require feature="setprefs"/>
    <#include "dynamic-translations.ftl"/>
    <Require feature="dynamic-height" />
    <#include "default-oauth-prefs.ftl"/>
  </ModulePrefs>
  <#include "context-prefs.ftl"/>
  <Content type="html">

<![CDATA[
<html>
  <head>
  <link rel="stylesheet" type="text/css" href="/nuxeo/site/skin/gadgets/css/gadget-common.css"/>
  <link rel="stylesheet" type="text/css" href="/nuxeo/site/skin/gadgets/css/documentlists.css"/>
  <link rel="stylesheet" type="text/css" href="news.css"/>

  <!-- insert JS Context -->
  ${jsContext}

  <script src="${specDirectoryUrl}default-automation-request.js"></script>
  <script src="${specDirectoryUrl}context-management.js"></script>
  <script src="${specDirectoryUrl}default-documentlist-display.js"></script>
  <script type="text/javascript" language="javascript" src="news.js"></script>
  <script type="text/javascript" language="javascript">
    // configure Automation REST call
    var NXRequestParams={ operationId : 'Social.Provider',            // id of operation or chain to execute
    operationParams : { query : "Select * from NewsItem WHERE ecm:currentLifeCycleState <> 'deleted'" +
        "AND ecm:isProxy = 1",
         pageSize : 5,
         contextPath : getTargetContextPath(),
         sortInfo : "dc:modified 1"
    },  // parameters for the chain or operation
    operationContext : {},                                                // context
    operationDocumentProperties : "common,dublincore,note",               // schema that must be fetched from resulting documents
    entityType : 'documents',                                             // result type : only document is supported for now
    usePagination : true,                                                 // manage pagination or not
    displayMethod : displayArticles,                                  // js method used to display the result
    noEntryLabel: '__MSG_label.gadget.no.document__'
  };


  </script>
  </head>

  <body>
     <div class="content">
      <#include "default-documentlist-layout.ftl"/>
      <#include "default-request-controls.ftl"/>
    </div>
  </body>
</html>
]]>

  </Content>
</Module>
