<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="All Articles"
    description="Diplay all Articles created into the Social Workspace"
    author="Ronan Le Gall" author_email="rlg@nuxeo.com"
    height="420">
    <Require feature="setprefs"/>
    <#include "dynamic-translations.ftl"/>
    <Require feature="dynamic-height" />
    <#include "default-oauth-prefs.ftl"/>
  </ModulePrefs>
  <#include "context-prefs.ftl"/>
  <Content type="html">

<![CDATA[
<html>
  <head>
  <link rel="stylesheet" type="text/css" href="/nuxeo/site/skin/gadgets/css/gadget-common.css"/>
  <link rel="stylesheet" type="text/css" href="/nuxeo/site/skin/gadgets/css/documentlists.css"/>
  <link rel="stylesheet" type="text/css" href="news.css"/>

  <!-- insert JS Context -->
  ${jsContext}

  <script src="${specDirectoryUrl}default-automation-request.js"></script>
  <script src="${specDirectoryUrl}context-management.js"></script>
  <script src="${specDirectoryUrl}default-documentlist-display.js"></script>
 <script type="text/javascript" language="javascript" src="publicdocuments.js"></script>
  <script type="text/javascript" language="javascript">
      //configuration leaved here to allow label traduction by shindig
      // configure Automation REST call
      var NXRequestParams={ operationId : 'Social.Provider',         // id of operation or chain to execute
        operationParams : { query : "Select * from Document WHERE ecm:currentLifeCycleState <> 'deleted'",
             pageSize : 5,
             socialWorkspacePath : getTargetContextPath(),
             onlyPublicDocumentsÂ : "true",                           //restrict the research to public-section
             sortInfo : "dc:modified 1"
        },  // parameters for the chain or operation
        operationContext : {},                                       // context
        operationDocumentProperties : "common,dublincore,note,file", // schema that must be fetched from resulting documents
        entityType : 'documents',                                    // result type : only document is supported for now
        usePagination : true,                                        // manage pagination or not
        displayMethod : displayResultsForPublicDocument,             // js method used to display the result
        noEntryLabel: '__MSG_label.gadget.no.document__'
      };
  </script>
  </head>

  <body>
     <div class="content">
      <#include "default-documentlist-layout.ftl"/>
      <#include "default-request-controls.ftl"/>
    </div>
  </body>
</html>
]]>

  </Content>
</Module>
